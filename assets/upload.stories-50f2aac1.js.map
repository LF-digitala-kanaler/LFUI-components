{"version":3,"file":"upload.stories-50f2aac1.js","sources":["../../src/docs/Upload/upload.html?raw","../../src/docs/Upload/upload.js"],"sourcesContent":["export default \"<p class=\\\"text-sm text-muted\\\">Default</p>\\n<div class=\\\"upload w-100\\\">\\n  <div class=\\\"upload-placeholder\\\"></div>\\n  <input\\n    class=\\\"upload-input\\\"\\n    type=\\\"file\\\"\\n    name=\\\"filename\\\"\\n    id=\\\"upload\\\"\\n    multiple />\\n  <label class=\\\"upload-label btn btn-secondary px-1\\\" for=\\\"upload\\\">\\n    <svg\\n      focusable=\\\"false\\\"\\n      aria-hidden=\\\"true\\\"\\n      class=\\\"icon mr-025\\\"\\n      width=\\\"24\\\"\\n      height=\\\"24\\\">\\n      <use xlink:href=\\\"lf-icons/sprite/24/icons.svg#attachment-24\\\"></use>\\n    </svg>\\n    Bifoga fil\\n  </label>\\n</div>\\n\\n<p class=\\\"text-sm mt-15 mb-05 text-muted\\\">Loading state test</p>\\n<div class=\\\"upload-preview mb-05\\\">\\n  <div class=\\\"upload-body\\\">\\n    <div class=\\\"upload-image mr-05\\\"></div>\\n    <span class=\\\"upload-name\\\">the-file-name.jpg</span>\\n\\n    <div id=\\\"upload2\\\" class=\\\"upload-progress\\\">\\n      <div class=\\\"upload-progress-bar\\\" role=\\\"progressbar\\\"></div>\\n    </div>\\n  </div>\\n</div>\\n<button class=\\\"link\\\" id=\\\"upload-test-btn\\\">Trigger</button>\\n\"","import { html, delegate } from '../../js/utils'\n\nconst uploadExample = (context) => {\n  if (!context) {\n    return\n  }\n\n  const element = context.querySelector('.upload')\n  if (!element) return null\n\n  const input = context.querySelector('.upload-input')\n  const placeholder = context.querySelector('.upload-placeholder')\n\n  const popoverMarkup = (data) => {\n    return html`\n      <div role=\"alert\" id=\"popover\" class=\"popover-tooltip popover-bottom popover-attach\">\n        <p class=\"popover-title\">Preview</p>\n        <div class=\"popover-content\">\n          <div class=\"card\">\n            <div class=\"card-block\">\n              <img class=\"img-fluid w-100\" src=${data.src} alt=\"\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    `\n  }\n\n  const createMarkup = (data) => {\n    return html`\n      <div class=\"upload-preview  mb-05 ${data.validationClass}\">\n        <div class=\"upload-body\">\n          ${data.popover === true\n            ? html`\n                <span\n                  role=\"button\"\n                  tabindex=\"-1\"\n                  class=\"popover-tooltip-trigger p-0 b-0  mr-05\"\n                  aria-controls=\"popover\">\n                  <img class=\"upload-image\" alt=\"\" src=${data.src} width=\"35\" height=\"35\" />\n                  ${popoverMarkup(data)}\n                </span>\n              `\n            : html`\n                <div class=\"upload-image mr-05\">${data.src}</div>\n              `}\n          <span class=\"upload-name\">${data.name}</span>\n          <button\n            type=\"button\"\n            class=\"btn-close ml-auto upload-remove\"\n            aria-label=\"Remove\"></button>\n        </div>\n        ${data.popover === false\n          ? html`\n              <small class=\"upload-feedback\">Description of error in input</small>\n            `\n          : ''}\n      </div>\n    `\n  }\n\n  const previewFile = (file) => {\n    const fileType = /image.*/\n    const reader = new window.FileReader()\n\n    if (file.type.match(fileType)) {\n      reader.readAsDataURL(file)\n\n      const data = {\n        src: '#',\n        name: ' ',\n        file: ' ',\n        popover: true,\n        validationClass: ' '\n      }\n      placeholder.append(createMarkup(data))\n\n      reader.onloadend = () => {\n        const data = {\n          src: reader.result,\n          name: file.name,\n          file,\n          popover: true,\n          validationClass: 'has-valid'\n        }\n\n        const children = [...placeholder.children].filter((el) =>\n          el.classList.contains('upload-preview')\n        )\n\n        children[0].replaceWith(createMarkup(data))\n      }\n    } else {\n      const data = {\n        src: ' ',\n        name: file.name,\n        file,\n        validationClass: 'has-danger',\n        popover: false\n      }\n      placeholder.append(createMarkup(data))\n    }\n  }\n\n  const handleFiles = (files) => {\n    Array.from(files).forEach((file) => {\n      previewFile(file)\n    })\n  }\n\n  const handleUpload = () => {\n    const FILES = input.files\n    handleFiles(FILES)\n  }\n\n  element.addEventListener('change', handleUpload)\n\n  context.addEventListener(\n    'click',\n    delegate('.upload-remove', function () {\n      this.parentElement.parentElement.remove()\n    })\n  )\n\n  input.addEventListener('focus', function () {\n    input.classList.add('has-focus')\n  })\n\n  input.addEventListener('blur', function () {\n    input.classList.remove('has-focus')\n  })\n\n  context.querySelector('#upload-test-btn').addEventListener('click', function () {\n    const upload = context.querySelector('#upload2')\n    const progress = upload.querySelector('.upload-progress-bar')\n\n    upload.classList.add('loading')\n    progress.removeAttribute('style')\n    upload.parentElement.parentElement.classList.remove('has-valid')\n\n    let timeleft = 100\n    const loaderTest = setInterval(function () {\n      timeleft--\n\n      progress.style.setProperty('transform', 'translateX(-' + timeleft + '%)')\n\n      if (timeleft <= 0) {\n        clearInterval(loaderTest)\n      }\n\n      if (timeleft === 0) {\n        upload.parentElement.parentElement.classList.add('has-valid')\n      }\n\n      upload.classList.remove('loading')\n    }, 15)\n  })\n}\n\nexport { uploadExample }\n"],"names":["Upload","uploadExample","context","element","querySelector","input","placeholder","popoverMarkup","data","html","src","createMarkup","validationClass","popover","name","previewFile","file","fileType","reader","window","FileReader","type","match","readAsDataURL","append","onloadend","result","children","filter","el","classList","contains","replaceWith","handleFiles","files","Array","from","forEach","handleUpload","FILES","addEventListener","delegate","parentElement","remove","add","upload","progress","removeAttribute","timeleft","loaderTest","setInterval","style","setProperty","clearInterval"],"mappings":"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"}